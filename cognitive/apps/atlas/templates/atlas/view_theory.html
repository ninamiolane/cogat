{% extends "main/base.html" %}
{% load crispy_forms_tags %}
{% load staticfiles %}
{% block head %}
<style>
.ui-autocomplete-loading { background: white url("/images/facebox/loading.gif") right center no-repeat; }
.asholder {position:relative;}
.select2-container { width: 100% !important; }
</style>
<link type="text/css" href="{% static "css/select2.min.css"%}" rel="stylesheet" media="screen">

{% endblock %}

{% block branding %}
{% include 'atlas/branding.html'%}
{% block navigation %}
{% include "atlas/middle_navigation.html" %}
{% endblock %}

{% endblock %}

{% block content %}
<div class="marger"><div class="CATerm collection">
  <h1 class="termtext">
    <a class="color-collection" href="">
            <em>{{ theory.name }}</em>
          </a>
    <span class="typebutton collection_type"><a href="{% url 'all_theories' %}">THEORY</a></span>
  </h1>
</div><!-- .CATerm.collection -->

<div class="defncol">{{ theory.description }}
<div class="attribo">
    <div class="classification">
    </div>
  
  <div class="attribution">
  </div>
</div><!-- .attribo -->

<div id="unterbutton_slide_def">
    <div class="unterbutton">
        <a href="#" class="slide_def actionator" id="update_theory">edit theory</a>	
    </div>
</div>
</div>
<div id="edit_theory" style="margin-bottom:30px;" class="hidden popstar"><br />
    <form method="post" action="{% url 'update_theory' theory.id %}" id="form_update_collection">
        <fieldset class="fsetter">
            <input type="hidden" name="theory_id" id="id_collection" value="{{ theory.id }}" />
            <input type="hidden" name="theory_name" id="theory_name" value="{{ theory.name }}" />
            <label class="collabel">Theory Description:</label><br />
            <textarea name="theory_description" id="theory_description" class="required" rows="8" cols="80" title="theory description" aria-label="theory description" >{{ theory.description }}</textarea><br /><br />
                <label class="collabel"></label>
                <input type="button" value="cancel" onclick="window.location.reload()" title="cancel submission" aria-label="cancel submission"  />
            <input type="submit" value="submit" title="submit form" aria-label="submit form" />
         </fieldset>
    </form>
</div>
<div id="block-holder" class="block-full">
    <div id="block-measurements" class="block-half">
        <h2>Constituent <strong>Assertions</strong></h2><br>
            <ul class="alister">
            {% for assertion in assertions %}
                <li class="similitude {{assertion.id}}">{{ assertion.name }}
                </li>
            {% endfor %}
            </ul>
            <small>REFERENCED TERMS:</small> 
            {% for name, values in referenced_terms.items %}
                <a href="{{ values.1 }}" class="hovermark">{{ name }}</a>({{ values.0 }})
            {% endfor %}
            <br>
            <a name="add_theory_assertion_button" id="add_theory_assertion_button" class="actionator">+ add constituent assertion</a><br>
            <div id="slidetarget_constass" class="hidden"><br>
                <div class="popstar">
                    <form method="post" name="theory-assertion-form" id="id-theory-assertion-form" action="{% url 'add_theory_assertion' theory.id %}">
                        {% crispy theory_assertions_form theory_assertions_form.helper %}
                     </form>
               </div>
           </div> 
      </div>
 </div> 
</div>

{% endblock %}
{% block scripts %}
<script src="{% static "js/select2.min.js"%}" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
    $(function() {
       $(".tooltip").tipsy({fade:false, gravity:"w", html:true});
       $("#masker").fadeOut("fast");
    });
    $("#update_theory").click(function(){
        $("#edit_theory").removeClass("hidden")
    })

    // Show input to add citation
    $("#add_theory_assertion_button").click(function(){
        $("#slidetarget_constass").removeClass('hidden');
    })
    $("#reset-id-theory-assertion-cancel").click(function(){
        $("#slidetarget_constass").addClass('hidden');
    })

    $(".select").select2({width: 'resolve'});
 
});
</script>
{% endblock %}
